{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">

	<link rel="icon" type="image/png" href="{% static 'images/favicon.png' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/normalize.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'icomoon/icomoon.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/vendor.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- Add Bootstrap CSS and Font Awesome CSS links -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

<!-- Add Bootstrap JavaScript link -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>


    <title>Post Your Review</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .review-card {
            background-color: #f9f9f9;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
          }
        
          .review-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
          }
        
          .reviewer-name {
            font-weight: bold;
            margin-left: 10px;
          }
        
          .review-date {
            font-size: 14px;
            color: #666;
            margin-left: 10px;
          }
        
          .review-body {
            margin-bottom: 20px;
          }
        
          .review-title {
            font-weight: bold;
            margin-bottom: 10px;
          }
        
          .review-description {
            font-size: 16px;
            color: #666;
          }
        
          .star-rating {
            margin-top: 10px;
          }
        
          .filled {
            color: #ffd700;
          }
        
          .half {
            color: #ffd700;
            position: relative;
          }
        
          .half::before {
            content: "\f005";
            position: absolute;
            top: 0;
            left: 0;
            width: 50%;
            overflow: hidden;
            color: #ffd700;
          }

          .container{
            max-width: 95%;
          }
        .container {
            max-width: 95%;
            margin: 50px auto;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .fa-star.checked {
            color: #C5A992;  /* Color for filled stars */
        }
        .review-container h2 {
            color: #C5A992;
            font-weight: bold;
            text-align: center;
        }
        .submit-btn {
            background-color: #C5A992;
            color: white;
        }
        .submit-btn:hover {
            background-color: #e0d5cd;
            color: white;
        }
        hr {
            border-top: 2px solid #C5A992;
        }
        .rating {
            display: flex;
            flex-direction: row-reverse;
            justify-content: flex-end;
            padding: 10px 0;
        }

        .rating input {
            display: none;
        }

        .rating label {
            font-size: 40px;
            color: #ccc;
            cursor: pointer;
            margin: 0;
        }

        .rating label:before {
            content: 'â˜…';
        }

        .rating input:checked ~ label {
            color: #C5A992;
        }

        .rating label:hover,
        .rating label:hover ~ label {
            color: #C5A992;
        }
        .review-date-container {
            margin-left: auto; /* Pushes the date to the right */
            padding: 5px 10px; /* Adds padding inside the date box */
            background-color: #f0f0f0; /* Light background color for the date box */
            border-radius: 5px; /* Rounds the corners of the date box */
            font-size: 14px; /* Adjust font size as needed */
            color: #333; /* Adjust text color */
        }

        /* Ensure color persists when hovering over rating */
        .rating input:checked ~ label:hover,
        .rating input:checked ~ label:hover ~ label {
            color: #C5A992;
        }
        .profile {
            border-radius: 50%;
            width: 50px;
            height: 50px;
        }
    </style>
</head>
<body>

    <div id="header-wrap">

		<div class="top-content">
			<div class="container-fluid">
				<div class="row">
					<div class="col-md-6">
						<div class="social-links">
							<ul>
								<li>
									<a href="#"><i class="icon icon-facebook"></i></a>
								</li>
								<li>
									<a href="#"><i class="icon icon-twitter"></i></a>
								</li>
								<li>
									<a href="#"><i class="icon icon-youtube-play"></i></a>
								</li>
								<li>
									<a href="#"><i class="icon icon-behance-square"></i></a>
								</li>
							</ul>
						</div><!--social-links-->
					</div>
					<div class="col-md-6">
						<div class="right-element">
							{% if request.session.email %}
								<a href="{% url 'profile' %}" class="user-account for-buy"><i
										class="icon icon-user"></i><span>Account</span></a>
							{% else %}
								<a href="{% url 'signin' %}" class="user-account for-buy"><i
									class="icon icon-user"></i><span>Login</span></a>
							{% endif %}
						</div><!--top-right-->
					</div>

				</div>
			</div>
		</div><!--top-content-->

		<header id="header">
			<div class="container-fluid">
				<div class="row">

					<div class="col-md-2">
						<div class="main-logo">
							<a href="index.html"><img src="{% static 'images/main-logo.png' %}" alt="logo"></a>
						</div>

					</div>

					<div class="col-md-10">

						<nav id="navbar">
							<div class="main-menu stellarnav">
								<ul class="menu-list">
                  <li class="menu-item"><a href="{% url 'index' %}">Home</a></li>
									<li class="menu-item has-sub">
										<a href="#pages" class="nav-link">Pages</a>

										<ul>
											<li><a href="{% url 'add_book' %}">Add Book</a></li>
											<li><a href="{% url 'manage_book' %}">Manage Book</a></li>
											<li><a href="{% url 'thankyou' %}">Thank You</a></li>
										</ul>

									</li>
									<li class="menu-item"><a href="#featured-books" class="nav-link"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
							
								</ul>

								<div class="hamburger">
									<span class="bar"></span>
									<span class="bar"></span>
									<span class="bar"></span>
								</div>

							</div>
						</nav>

					</div>

				</div>
			</div> 
		</header>

	</div><!--header-wrap-->


    <div class="container review-container">
        {% if user.profile_image %}
                <div class="alert alert-success" role="alert">
                    <center>Welcome, {{ user.name }}! Post Your Helpfull Review for Our BooksðŸ’«</center>
                </div>
                {% endif %}
        <h2>Post Your Review</h2>
        <hr>
        <form action="{% url 'add_review' book.id %}" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            
            {% for msg in messages %}
    <script>
        const Toast = Swal.mixin({
            toast: true,
            position: "top",
            showConfirmButton: false,
            timer: 5000,
            timerProgressBar: true,
            didOpen: (toast) => {
            toast.onmouseenter = Swal.stopTimer;
            toast.onmouseleave = Swal.resumeTimer;
            }
        });

        let iconType = "{{ msg.tags }}";  

        Toast.fire({
            icon: iconType,
            title: "{{ msg }}"
        });
    </script>
    {% endfor %}


            <!-- Display book information -->
            {% if book.book_image %}
            <center>
                <img src="{{ book.book_image.url }}" alt="Current Book Image" class="img-thumbnail mb-2" style="max-width: 200px;">
                <h3>{{ book.book_name }}</h3>
                <span>{{ book.book_author }}</span>
                <div class="item-price">{{ book.book_price }}</div>
            </center>
            <hr>
            {% endif %}
            
            <!-- Hidden fields for user profile and name -->
            <input hidden class="form-control" name="book_name" value="{{ book.book_name }}">
            <input hidden class="form-control" name="user_profile" value="{{ user.profile_image.url }}">
            <input hidden class="form-control" name="user_name" value="{{ user.name }}">
            
            <!-- Review form fields -->
            <div class="mb-3">
                <label for="reviewTitle" class="form-label">Review Title</label>
                <input type="text" class="form-control" name="review_title" placeholder="Enter Review Title" required>
            </div>
            
            <div class="mb-3">
                <label for="reviewDescription" class="form-label">Review Description</label>
                <textarea class="form-control" name="review_description" rows="4" placeholder="Enter Review Description" required></textarea>
            </div>
            
            <label class="form-label">Rating on Book</label>
            <div class="rating">
                <input value="5" name="rating" id="star5" type="radio" required>
                <label title="5 stars" for="star5"></label>
                <input value="4" name="rating" id="star4" type="radio">
                <label title="4 stars" for="star4"></label>
                <input value="3" name="rating" id="star3" type="radio">
                <label title="3 stars" for="star3"></label>
                <input value="2" name="rating" id="star2" type="radio">
                <label title="2 stars" for="star2"></label>
                <input value="1" name="rating" id="star1" type="radio">
                <label title="1 star" for="star1"></label>
            </div>
            
            <div class="d-grid gap-2">
                <button type="submit" class="btn submit-btn">Submit Review</button>
            </div>
        </form>        
    </div>

    

    <!-- Review component HTML code -->
    {% for review in reviews %}
<div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="review-card">
          <div class="review-header">
            <img src="{{ review.user_profile }}" alt="User  Profile Picture" class="profile">
            <h5 class="reviewer-name">{{ review.user_name }}</h5>
            <div class="review-date-container">
              <span class="review-date">Reviewed on: {{ review.date|date:"F d, Y, H:i:s" }}</span>

            </div>
          </div>
          <div class="review-body">
            <h6 class="review-title">{{ review.review_title }}</h4>
            <p class="review-description">{{ review.review_description }}</p>
            <div class="star-rating">
                {% for i in star_range %}
                    <i class="fa fa-star {% if i <= review.rating %}checked{% endif %}"></i>
                {% endfor %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
    <hr>
    <!-- Font Awesome for Star Icons -->
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>    
    <!-- Bootstrap JS (Optional) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script src="{% static 'js/jquery-1.11.0.min.js' %}"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
		crossorigin="anonymous"></script>
	<script src="{% static 'js/plugins.js' %}"></script>
	<script src="{% static 'js/script.js' %}"></script>
</body>
</html>
