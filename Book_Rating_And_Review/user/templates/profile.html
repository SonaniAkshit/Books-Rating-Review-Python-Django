{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <title>BookSaw - Profile</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="{% static 'images/favicon.png' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/normalize.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'icomoon/icomoon.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/vendor.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">

    <link rel="stylesheet" href="{% static 'profile.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<style>

    body {
        background-color: #F3F2EC;
    }

    .profile {
        border-radius: 50%;
        width: 100px;
        height: 100px;
    }
    .profile1 {
        border-radius: 50%;
        width: 50px;
        height: 50px;
    }

    .resetbtn {
        background: #000;
        color: #fff;
        padding: 5px 15px;
        border-radius: 5px;
        border: none;
    }

    .resetbtn:hover {
        background: #C5A992;
    }

    .material-symbols-outlined {
        align-items: center;
        font-size: 20px;
    }

    .a {
        background: none;
        border: none;
        color: rgb(157, 158, 159);
    }

    .a:hover {
        border-bottom: 1px solid #C5A992;
        color: #C5A992;
    }

    .alert {
        margin-top: 2%;
        color: #07553B;
        background: #D1E7DD;
        font-size: 20px;
    }

    .alert1 {
        margin-top: 2%;
        padding: 10px 10px;
        color: #842029;
        font-size: 20px;
        border-radius: 4px;
        background: #F8D7DA;
    }
    .btn1 {
        border: none;
        background: none;
        padding: 0;
        cursor: pointer;
    }
    
</style>

<body>
    {% if request.session.email %}
    <div id="header-wrap">

		<div class="top-content">
			<div class="container-fluid">
				<div class="row">
					<div class="col-md-6">
						<div class="social-links">
							<ul>
								<li>
									<a href="#"><i class="icon icon-facebook"></i></a>
								</li>
								<li>
									<a href="#"><i class="icon icon-twitter"></i></a>
								</li>
								<li>
									<a href="#"><i class="icon icon-youtube-play"></i></a>
								</li>
								<li>
									<a href="#"><i class="icon icon-behance-square"></i></a>
								</li>
							</ul>
						</div><!--social-links-->
					</div>
					<div class="col-md-6">
						<div class="right-element">
							{% if request.session.email %}
								<a class="active" href="{% url 'profile' %}" class="user-account for-buy">
                                        <img class="profile1" src="{{ user.profile_image.url }}" alt="none" class="d-block ui-w-80"></a>
							{% else %}
								<a href="{% url 'signin' %}" class="user-account for-buy"><i
									class="icon icon-user"></i><span>Login</span></a>
							{% endif %}
						</div><!--top-right-->
					</div>

				</div>
			</div>
		</div><!--top-content-->
        <header id="header">
			<div class="container-fluid">
				<div class="row">

					<div class="col-md-2">
						<div class="main-logo">
							<a href="index.html"><img src="{% static 'images/main-logo.png' %}" alt="logo"></a>
						</div>

					</div>

					<div class="col-md-10">

						<nav id="navbar">
							<div class="main-menu stellarnav">
								<ul class="menu-list">
                                    <li class="menu-item"><a href="{% url 'index' %}">Home</a></li>
									<li class="menu-item has-sub">
										<a href="#pages" class="nav-link">Pages</a>

										<ul>
											<li><a href="{% url 'add_book' %}">Add Book</a></li>
											<li><a href="{% url 'manage_book' %}">Manage Book</a></li>
											<li><a href="{% url 'thankyou' %}">Thank You</a></li>
										</ul>

									</li>
									<li class="menu-item"><a href="#featured-books" class="nav-link"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
							
								</ul>

								<div class="hamburger">
									<span class="bar"></span>
									<span class="bar"></span>
									<span class="bar"></span>
								</div>

							</div>
						</nav>

					</div>

				</div>
			</div>
		</header>

	</div><!--header-wrap-->

    <form action="" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        
        <div class="container light-style flex-grow-1 container-p-y">
            <br><br>
            <div class="card overflow-hidden">
                <div class="row no-gutters row-bordered row-border-light">
                    <div class="col-md-3 pt-0">
                        <div class="list-group list-group-flush account-settings-links">
                            <a class="list-group-item list-group-item-action active" data-toggle="list"
                                href="#account-general">General</a>
                            <a class="list-group-item list-group-item-action" data-toggle="list" href="#account-info">Info</a>
                            <!-- <a class="list-group-item list-group-item-action" href="{% url 'index' %}">Home</a> -->
                            <a class="list-group-item list-group-item-action">
                                <!-- Separate logout form -->
                            </a>
                        </div>
                    </div>
                    <div class="col-md-9">
                        <div class="tab-content">
                            <div class="tab-pane fade active show" id="account-general">
                                <div class="card-body media align-items-center">
                                    <img class="profile" src="{{ user.profile_image.url }}" alt="none" class="d-block ui-w-80">
                                </div>
                                <hr class="border-light m-0">
                                <div class="card-body">
                                    <div class="form-group">
                                        <label class="form-label">Name</label>
                                        <input type="text" name="name" class="form-control" value="{{ user.name }}">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Phone</label>
                                        <input type="text" name="contact" class="form-control" value="{{ user.contact }}">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">E-mail</label>
                                        <input readonly type="email" name="email" class="form-control mb-1" value="{{ user.email }}">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Password</label>
                                        <input readonly type="text" name="password" class="form-control" value="{{ user.password }}">
                                        <div class="alert">
                                            <span class="material-symbols-outlined">verified_user</span> Your Account Has Been Verified.<br>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="account-info">
                                <form action="{% url 'profile' %}" method="POST">
                                    {% csrf_token %}

                                <div class="card-body pb-2">
                                    <h6 class="mb-4">Edit Your Profile</h6>
                                    <hr>
                                </div>
                                <div class="card-body pb-2">
                                    <div class="form-group">
                                        <label class="form-label">City</label>
                                        <input type="text" name="city" class="form-control" value="{{ user.city }}">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">State</label>
                                        <input type="text" name="state" class="form-control" value="{{ user.state }}">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Pincode</label>
                                        <input type="text" name="pincode" class="form-control" value="{{ user.pincode }}">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Country</label>
                                        <input type="text" name="country" class="form-control" value="{{ user.country }}">
                                    </div>

                                    <div class="form-group">
                                    <label for="profile_image">Profile Image:</label>
                                    <input type="file" accept="image/png, image/jpg, image/jpeg, image/webp" name="profile_image" value="{{ user.profile_image }}">
                                    </div>

                                    <div class="text-right">
                                        <button type="submit" name="save" class="resetbtn">Save changes</button>
                                    </div>
                                </div>
                            </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br>
            <form action="{% url 'logout' %}" method="POST">
                {% csrf_token %}
                <div class="text-right">
                    <button class="resetbtn" type="submit">Logout</button>
                </div>
            </form>
        </div>
        {% endif %}

        {% for msg in messages %}
        <script>
            const Toast = Swal.mixin({
                toast: true,
                position: "top",
                showConfirmButton: false,
                timer: 5000,
                timerProgressBar: true,
                didOpen: (toast) => {
                    toast.onmouseenter = Swal.stopTimer;
                    toast.onmouseleave = Swal.resumeTimer;
                }
            });

            let iconType = "{{ msg.tags }}";  

            Toast.fire({
                icon: iconType,
                title: "{{ msg }}"
            });
        </script>
        {% endfor %}

  
        
        {% if show_alert %}
        <script>
            Swal.fire({
                title: "Visit Again!",  // Modify this text as per your message
                icon: "success",
                showConfirmButton: false,
                timer: 2000  // Duration of the SweetAlert
            });

            // Redirect after the SweetAlert notification is shown
            setTimeout(function() {
                window.location.href = "{% url 'signin' %}";  // Replace 'signin' with your actual URL name
            }, 2000);  // Time here should match the duration of the SweetAlert timer
        </script>
        {% endif %}
    </form>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.bundle.min.js"></script>

    <script src="{% static 'js/jquery-1.11.0.min.js' %}"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
		crossorigin="anonymous"></script>
	<script src="{% static 'js/plugins.js' %}"></script>
	<script src="{% static 'js/script.js' %}"></script>

</body>

</html>
